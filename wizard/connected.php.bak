<html>
<head>
    <title></title>
</head>
<body>
<br><br>
</body>

<?php
if(isset($_POST['ssid']) && isset($_POST['key'])) {
	//Format input values as args
	$argSSID=escapeshellarg($_POST['ssid']);
	$argKEY=escapeshellarg($_POST['key']);

	//Add connection, put it up
	shell_exec('sudo nmcli con delete '.$argSSID);
	shell_exec('sudo nmcli con add con-name '.$argSSID.' ifname wlan0 type wifi ssid '.$argSSID);
	shell_exec('sudo nmcli con modify '.$argSSID.' wifi-sec.key-mgmt wpa-psk');
	shell_exec('sudo nmcli con modify '.$argSSID.' wifi-sec.psk '.$argKEY);
	shell_exec('sudo nmcli con up '.$argSSID);
	echo "Connected to ".shell_exec('iwgetid -r')."<br>IP: ".exec('hostname -I');
}
else {
   die('<br><br>no post data to process');
}
?>
